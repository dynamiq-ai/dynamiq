connections:
  openai-conn:
    type: dynamiq.connections.OpenAI

nodes:
  xlsx-agent:
    type: dynamiq.nodes.agents.Agent
    llm:
      id: xlsx-agent-llm
      type: dynamiq.nodes.llms.OpenAI
      connection: openai-conn
      model: gpt-4o
    tools:
      - id: python-executor
        type: dynamiq.nodes.tools.python_code_executor.PythonCodeExecutor
        name: python_executor
        file_store:
          type: dynamiq.storages.file.InMemoryFileStore
    role: |
      You have access to skills and a Python code executor. Use the SkillsTool to list skills and get the xlsx skill content (README/SKILL) so you know how to create Excel workbooks with openpyxl and formulas. Then use the code executor to build the Excel following the skill's guidelines (formulas, not hardcoded values). Produce clear reports and summarize findings in text. Format responses in Markdown.
    file_store:
      enabled: true
      backend:
        type: dynamiq.storages.file.InMemoryFileStore
      agent_file_write_enabled: true
    skills_enabled: true
    max_loops: 12
    inference_mode: XML

flows:
  xlsx-agent-flow:
    name: Xlsx Price Dashboard Flow
    nodes:
      - xlsx-agent

workflows:
  xlsx-price-dashboard-workflow:
    flow: xlsx-agent-flow
    version: 1
